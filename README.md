[Русская версия](./README.md) | [English version](./README.en.md)

Связанные документы: [CHANGELOG.md](./CHANGELOG.md) | [CHANGELOG.en.md](./CHANGELOG.en.md) | [RELEASE_NOTES.md](./RELEASE_NOTES.md) | [RELEASE_NOTES.en.md](./RELEASE_NOTES.en.md) | [RELEASE_PAGE.md](./RELEASE_PAGE.md) | [RELEASE_PAGE.en.md](./RELEASE_PAGE.en.md)

# 202312-todo

`202312-todo` это локальный менеджер задач на Python с CLI-интерфейсом, SQLite-хранилищем и экспериментальным REST API на FastAPI. Проект закрывает базовый CRUD-сценарий для personal task tracking: создать задачу, посмотреть список, отметить выполнение, удалить запись.

Статус проекта: `MVP`.

Проект выглядит как практическая инженерная заготовка для личного использования и дальнейшего развития. Основной рабочий сценарий сейчас сосредоточен вокруг CLI; API уже существует, но по состоянию на 28 февраля 2026 года остается ограниченным и должен рассматриваться как экспериментальный слой доступа к данным.

## Оглавление

- [Назначение](#назначение)
- [Контекст проекта](#контекст-проекта)
- [Текущий статус](#текущий-статус)
- [Архитектура](#архитектура)
- [Основные модули](#основные-модули)
- [Контракт данных](#контракт-данных)
- [Конфигурация](#конфигурация)
- [Быстрый старт](#быстрый-старт)
- [Как быстро проверить проект](#как-быстро-проверить-проект)
- [CLI-сценарии](#cli-сценарии)
- [REST-API](#rest-api)
- [Локальные данные и логи](#локальные-данные-и-логи)
- [Тесты](#тесты)
- [FAQ и частые проблемы](#faq-и-частые-проблемы)
- [Ограничения MVP](#ограничения-mvp)
- [Дальнейшее развитие](#дальнейшее-развитие)
- [Релизные документы](#релизные-документы)
- [Лицензия](#лицензия)

## Назначение

Проект решает простой и понятный сценарий: локальное ведение списка задач без внешней инфраструктуры. Вместо web-приложения или облачного сервиса здесь используется SQLite и консольный интерфейс, поэтому проект подходит для:

- локальной работы с personal todo list;
- быстрой проверки CRUD-логики на Python;
- дальнейшего наращивания API или UI поверх уже существующей модели данных;
- учебно-практического использования как основы для небольшого task manager.

С точки зрения поиска и описания назначения проект естественно попадает в темы `python todo app`, `CLI task manager`, `SQLite task tracker`, `FastAPI REST API`, `CRUD application`.

## Контекст проекта

По структуре репозитория и характеру кода это реальный прикладной проект, а не витринный шаблон. В проекте есть:

- CLI для ежедневных операций с задачами;
- слой работы с SQLite;
- конфигурация через `.ini`;
- логирование в файл;
- тесты для DB-слоя, CLI и API;
- минимальный FastAPI-интерфейс для чтения данных.

Авторские комментарии в коде и наличие экспериментальных участков показывают, что проект развивался итеративно: сначала как локальный CLI, затем как основа для API-доступа.

## Текущий статус

На момент проверки подтверждено следующее:

- CLI запускается и показывает справку.
- База SQLite создается и используется как основное хранилище.
- Основные операции с задачами реализованы в DB-слое.
- FastAPI-приложение отвечает на `/`, `/all`, `/last`, `/task/{id}`.
- В репозитории есть тесты, но воспроизводимость части тестового контура зависит от локального окружения.

Что важно учитывать честно:

- API ограничен чтением и не выглядит завершенным как публичный контракт.
- В коде есть `TODO`, связанные с путями, конфигом и дальнейшей доработкой логики.
- Один из CLI-тестов может падать не из-за логики приложения, а из-за состояния `uv` cache в конкретной среде.

## Архитектура

Проект собран как небольшой Python-монолит с разделением по ролям:

1. `src/cli` содержит пользовательский консольный интерфейс.
2. `src/db_access` инкапсулирует SQL-операции и вывод данных.
3. `src/api` предоставляет REST API поверх того же SQLite-хранилища.
4. `src/cfg` отвечает за конфиг и логирование.
5. `src/data` содержит SQL-дамп и скрипт инициализации базы.
6. `tests` покрывает базовые сценарии CLI, API и DB.

Упрощенный поток данных:

```text
CLI / FastAPI
    -> cfg
    -> db_access
    -> SQLite database
    -> formatted output / JSON response
```

## Основные модули

### `src/cli`

CLI является основным интерфейсом проекта. Через него доступны операции:

- создание базы данных;
- добавление задачи;
- просмотр списка задач;
- установка deadline;
- отметка задачи как выполненной;
- удаление задачи.

### `src/db_access/db_working.py`

Ключевой модуль бизнес-логики текущего MVP. Здесь реализованы:

- создание БД и таблицы;
- вставка записей;
- выборка одной, последней или всех записей;
- обновление deadline;
- отметка выполнения;
- удаление записи;
- интерактивное подтверждение опасных действий.

### `src/db_access/db_working_api.py`

Адаптер для API-слоя. Возвращает данные из SQLite в JSON-формате через FastAPI `Response`. На текущем этапе это скорее прикладная прослойка, чем стабильный API SDK.

### `src/api`

FastAPI-приложение с минимальным набором GET-эндпоинтов. Это полезно для простой интеграции, диагностики и внешнего чтения задач, но не выглядит как завершенный REST API для production-использования.

### `src/cfg`

Содержит:

- поиск и чтение `todo_config.ini`;
- определение имени БД;
- настройку логирования в `src/log/todo_cli.log`.

### `src/data`

Содержит:

- SQL-дамп с примерными данными;
- скрипт инициализации БД;
- рабочую директорию для SQLite-файлов.

## Контракт данных

Основная доменная сущность одна: задача в таблице `my_todo_list`.

### Таблица `my_todo_list`

| Поле | Тип в текущей схеме | Назначение |
| --- | --- | --- |
| `id` | `INTEGER PRIMARY KEY` | Уникальный идентификатор задачи |
| `data_of_creation` | без жесткой типизации SQLite | Дата и время создания записи |
| `date_max` | `TEXT` | Крайний срок выполнения, если установлен |
| `todo_text` | `TEXT` | Основной текст задачи |
| `is_gone` | `INTEGER` | Признак завершения: `0` или `1` |
| `date_of_gone` | `TEXT` | Дата и время закрытия задачи |

### Семантика полей

- `todo_text` это обязательное полезное содержимое записи.
- `date_max` может быть `NULL`, если deadline не задан.
- `is_gone = 0` означает активную задачу.
- `is_gone = 1` означает завершенную задачу.
- `date_of_gone` заполняется при переводе задачи в завершенное состояние.

### Формат даты

Проект использует строковый формат даты и времени `ДД.ММ.ГГГГ ЧЧ:ММ`, например `28.02.2026 20:40`. Это просто для CLI, но не идеально для строгой машинной интеграции.

## Конфигурация

Базовая конфигурация лежит в `src/cfg/todo_config.ini`.

Текущий параметр:

```ini
[db_cfg]
db_name = todo_main.db
```

Дополнительно имя БД можно переопределить через переменную окружения `TODO_DB_NAME`.

Что важно:

- конфигурация минимальная;
- часть логики поиска файлов пока жестко завязана на структуру репозитория;
- для MVP этого достаточно, но для дальнейшего развития конфиг лучше формализовать.

## Быстрый старт

### Требования

- Python `3.12+`
- `uv` для синхронизации окружения, если вы используете workflow проекта

### Установка зависимостей

```bash
uv sync
```

### Создание базы данных

```bash
uv run python -m src.cli --create_db
```

### Просмотр справки CLI

```bash
python -m src.cli --help
```

### Запуск API

```bash
uv run python -m src.api
```

После старта API обычно доступен по адресу `http://127.0.0.1:8000`.

## Как быстро проверить проект

Минимальный сценарий быстрой проверки:

1. Установить зависимости через `uv sync`.
2. Создать БД командой `uv run python -m src.cli --create_db`.
3. Добавить задачу: `uv run python -m src.cli --task_add "Проверка проекта"`.
4. Вывести список: `uv run python -m src.cli --tasks_list`.
5. Запустить API: `uv run python -m src.api`.
6. Проверить `GET /` и `GET /all`.

Если нужен быстрый старт с данными, можно загрузить примерный SQL-дамп:

```bash
uv run python src/data/init_db.py
```

## CLI-сценарии

Примеры основных команд:

```bash
python -m src.cli --create_db
python -m src.cli --task_add "Купить молоко"
python -m src.cli --tasks_list
python -m src.cli --completed_at 1
python -m src.cli --task_del_id 1
```

Особенность текущей реализации: некоторые операции требуют интерактивного подтверждения через `y/n`.

## REST-API

Текущий набор эндпоинтов:

- `GET /` возвращает простое сервисное сообщение.
- `GET /all` возвращает все задачи.
- `GET /last` возвращает последнюю задачу.
- `GET /task/{id}` возвращает задачу по идентификатору.

Это полезно для:

- простого внешнего чтения данных;
- подключения lightweight frontend;
- локальной интеграции с ботом или автоматизацией;
- диагностики состояния SQLite-хранилища через HTTP.

Что ограничивает API сейчас:

- нет полноценного набора методов записи;
- OpenAPI-описание в репозитории минимальное;
- контракт еще не выглядит стабилизированным.

## Локальные данные и логи

- SQLite-файлы находятся в `src/data/`.
- SQL-дамп примеров находится в `src/data/sqlite-example-data-db-utf-8.sql`.
- Логи CLI пишутся в `src/log/todo_cli.log`.

Это делает проект полностью локальным: без отдельного сервера БД, без внешнего message broker, без облачной зависимости.

## Тесты

В проекте есть тесты для трех уровней:

- `tests/test_db_working.py` проверяет создание БД, запись, обновление и удаление.
- `tests/test_cli.py` проверяет запуск CLI и доступность основных аргументов.
- `tests/test_api.py` проверяет базовые маршруты FastAPI и интеграцию через `TestClient`.

Практический смысл тестов:

- зафиксировать базовую работоспособность CRUD-ядра;
- быстро ловить регрессии в CLI-параметрах;
- не сломать минимальный API-контракт при изменениях.

Честное ограничение: часть тестового запуска зависит от локальной среды, в частности от состояния `uv` и прав доступа к cache-каталогам.

## FAQ и частые проблемы

### Почему CLI работает, а тест `test_cli.py` может падать?

В текущей реализации тест предпочитает запуск через `uv run`, если `uv` найден в `PATH`. Если локальный `uv` cache поврежден или недоступен по правам, тест упадет раньше запуска самого приложения.

### Где физически лежит база данных?

По умолчанию файл БД создается в `src/data/` и называется `todo_main.db`.

### Можно ли переопределить имя БД?

Да. Для этого используется переменная окружения `TODO_DB_NAME`.

### Это production-ready API?

Нет. Текущее состояние проекта лучше описывать как `MVP` с рабочим CLI и экспериментальным API.

### Есть ли локальный simulator или dev server?

Отдельного simulator нет. В роли локального dev-сценария выступают:

- SQLite с примерным SQL-дампом;
- FastAPI-сервер, запускаемый локально;
- `TestClient` в тестах API.

## Ограничения MVP

- Нет полноценного разделения на domain model, service layer и transport layer.
- Формат дат строковый и не нормализован в строгую схему.
- API ограничен в основном операциями чтения.
- Часть CLI-операций интерактивна, что неудобно для автоматизации.
- Конфигурация минимальна и частично завязана на файловую структуру репозитория.
- Тестовая воспроизводимость зависит от локального окружения.
- Нет web UI, multi-user режима, авторизации и синхронизации.

## Дальнейшее развитие

Логичные направления развития:

1. Стабилизировать API-контракт и добавить операции записи.
2. Уйти от строковых дат к явной схеме данных.
3. Разделить бизнес-логику, слой доступа к БД и слой представления.
4. Добавить неинтерактивный режим CLI для CI и автоматизации.
5. Расширить OpenAPI-описание и привести ответы API к единому формату.
6. Улучшить конфигурацию и обработку путей.
7. При необходимости добавить web UI поверх уже существующего API.

## Релизные документы

- Русские документы: [CHANGELOG.md](./CHANGELOG.md), [RELEASE_NOTES.md](./RELEASE_NOTES.md), [RELEASE_PAGE.md](./RELEASE_PAGE.md)
- English documents: [CHANGELOG.en.md](./CHANGELOG.en.md), [RELEASE_NOTES.en.md](./RELEASE_NOTES.en.md), [RELEASE_PAGE.en.md](./RELEASE_PAGE.en.md)

## Лицензия

Проект распространяется под лицензией `Apache License 2.0`.

Почему этот выбор адекватен для проекта:

- лицензия уже используется в репозитории;
- она подходит для прикладного software-проекта с возможностью дальнейшей доработки и переиспользования;
- она не навязывает нестандартных ограничений и хорошо совместима с обычным open-source workflow.

Полные тексты лицензии:

- [LICENSE](./LICENSE)
- [LICENSE-ru](./LICENSE-ru)
- [LICENSE-en](./LICENSE-en)

Кратко об условиях использования:

- код можно использовать, модифицировать и распространять;
- требуется сохранять текст лицензии и уведомления об авторских правах;
- проект предоставляется `AS IS`, без гарантий.
